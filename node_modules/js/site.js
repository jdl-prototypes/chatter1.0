var socket = io();
      var userID = '';
      var userName = '';

function sendMessage(){
  var message = $('#m').val();
  socket.emit('chatMessage', {'UserID':userID, 'Message':message});
  $('#m').val('');
}

function setUsername(username){
  socket.emit('setUsername',{name:username});
}

newExcitingAlerts = (function () {
  var oldTitle = document.title;
  var msg = "New!";
  var timeoutId;
  var blink = function() { document.title = document.title == msg ? ' ' : msg; };
  var clear = function() {
    clearInterval(timeoutId);
    document.title = oldTitle;
    window.onmousemove = null;
    timeoutId = null;
  };
  return function () {
    if (!timeoutId) {
      timeoutId = setInterval(blink, 1000);
      window.onmousemove = clear;
    }
  };
}());

$(document).ready(function(){
  /*var person = prompt('Please Enter your Nickname:', '');
  if(person!=null){
    setUsername(person);
  }*/

  $('#sendMessage').click(function(){
    sendMessage();
  });

});

$(document).keypress(function(e){
  if(e.which==13){
    e.preventDefault();
    sendMessage();
  }
});



socket.on('chatMessage', function(msg){
  $('#messages').append($('<li>').text(msg));
  newExcitingAlerts();
});

socket.on('setUsername', function(val){
  userID=val['UserID'];
  userName=val['Username'];
  $('#messages').append($('<li>').text(userName+userID + ' has connected.'));
});
